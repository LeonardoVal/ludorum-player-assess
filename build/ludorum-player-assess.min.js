//! ludorum-player-assess 0.0.1

(function(e){"use strict";"function"==typeof define&&define.amd?define(["creatartis-base","sermat","ludorum"],e):"object"==typeof exports&&module.exports?module.exports=e(require("creatartis-base"),require("sermat"),require("ludorum")):this["ludorum-player-assess"]=e(this.base,this.Sermat,this.ludorum)}).call(this,function e(a,n,r){"use strict";var t=a.raiseIf,o={__package__:"ludorum-player-assess",__name__:"ludorum_player_assess",__init__:e,__dependencies__:[a,n],ludorum:r,__SERMAT__:{include:[a,r]},compare:function(e){t(!e||!e.game,"Missing `game` argument!");var n,o=e.game,s=e.player1||new r.players.RandomPlayer({name:"RandomPlayer1"}),u=e.player2||new r.players.RandomPlayer({name:"RandomPlayer2"}),i=e.opponents||[new r.players.RandomPlayer({name:"RandomOpponent"})],l=+e.matchCount||400,c=e.logger,m=new r.tournaments.Measurement(o,s,i,l),f=new r.tournaments.Measurement(o,u,i,l);if(c){c.info("Starting "+4*l+" matches of "+o.name+".");var p=0;[m,f].forEach(function(e){e.events.on("afterMatch",function(){p++})}),n=setInterval(function(){c.info("Played "+p+"/"+4*l+" matches.")},e.logTime||2e4)}return a.Future.all([m.run(),f.run()]).then(function(){var e={};return o.players.forEach(function(a){var n=m.statistics,r=f.statistics;(e[s.name]||(e[s.name]={}))[a]=[n.count({key:"victories",role:a,player:s.name}),n.count({key:"draws",role:a,player:s.name}),n.count({key:"defeats",role:a,player:s.name})],(e[u.name]||(e[u.name]={}))[a]=[r.count({key:"victories",role:a,player:u.name}),r.count({key:"draws",role:a,player:u.name}),r.count({key:"defeats",role:a,player:u.name})]}),e}).then(function(e){return c&&(clearInterval(n),c.info("Played "+p+"/"+l+" matches.")),e})}},s=o.hypergeometricRule=function(e,a){var n=0,r=[0,0],t=e.map(function(e,t){return r[0]+=e,r[1]+=a[t],n+=e+a[t],e+a[t]}),o=new Array(n+1);r.concat(t).forEach(function(e){for(var a=2;a<=e;a++)o[a]=1+(0|o[a])}),[n].concat(e,a).forEach(function(e){for(var a=2;a<=e;a++)o[a]=(0|o[a])-1});for(var s=1,u=2,i=2;u<=n||i<=n;)s<=1&&u<=n?(o[u]>0&&(s*=Math.pow(u,o[u])),u++):(o[i]<0&&(s*=Math.pow(i,o[i])),i++);return s};return o.fisher2x2=function(e,a,n){t(2!==e.length||2!==a.length,"Contingency table should be 2x2!"),n=isNaN(n)?.05:+n;var r=e[0],o=e[1],u=a[0],i=a[1],l=r+o,c=u+i,m=r+u,f=Math.abs(r/l-u/c),p=Math.min(l,m),y=0;for(r=0;r<=p;r++)o=l-r,(i=c-(u=m-r))>=0&&Math.abs(r/l-u/c)>=f&&(y+=s([r,o],[u,i]));return{p_value:y,comparison:y>n?0:e[0]-a[0]}},o.fisher2x3=function(e,a,n){t(3!==e.length||3!==a.length,"Contingency table should be 2x3!"),n=isNaN(n)?.05:+n;var r,o,u=e[0],i=e[1],l=e[2],c=a[0],m=a[1],f=a[2],p=u+i+l,y=u+c,h=i+m,d=l+f,_=s([u,i,l],[c,m,f]),v=Math.min(p,y),g=0;for(u=0;u<=v;u++)for(o=Math.min(p-u,h),i=0;i<=o;i++)c=y-u,m=h-i,(f=d-(l=p-u-i))>=0&&(r=s([u,i,l],[c,m,f]))<=_&&(g+=r);return{p_value:g,comparison:g>n?0:e[0]-a[0]||(e[1]-row[1])/(h+1)}},o});
//# sourceMappingURL=ludorum-player-assess.min.js.map