//! ludorum-player-assess 0.0.1

(function(e){"use strict";this["ludorum-player-assess"]=e(this.base,this.Sermat,this.ludorum)}).call(this,function e(n,a,r){"use strict";var t=n.raiseIf,o={__package__:"ludorum-player-assess",__name__:"ludorum_player_assess",__init__:e,__dependencies__:[n,a],ludorum:r,__SERMAT__:{include:[n,r]},compare:function(e){t(!e||!e.game,"Missing `game` argument!");var a,o=e.game,u=e.players||[new r.players.RandomPlayer({name:"RandomPlayer"})],s=e.opponents||[new r.players.RandomPlayer({name:"RandomOpponent"})],i=+e.matchCount||400,c=e.logger,l=u.map(function(e){return new r.tournaments.Measurement(o,e,s,i)});if(c){c.info("Starting "+i*u.length*2+" matches of "+o.name+".");var m=0;l.forEach(function(e){e.events.on("afterMatch",function(){m++})}),a=setInterval(function(){c.info("Played "+m+"/"+i*u.length*2+" matches.")},e.logTime||2e4)}return n.Future.all(l.map(function(e){return e.run()})).then(function(){return l.map(function(e,a){var r=e.statistics,t=u[a],s=n.iterable(o.players).map(function(e){return[e,[r.count({key:"victories",role:e,player:t.name}),r.count({key:"draws",role:e,player:t.name}),r.count({key:"defeats",role:e,player:t.name})]]}).toObject();return s.player=t.name,s})}).then(function(e){return c&&(clearInterval(a),c.info("Played "+m+"/"+i*u.length*2+" matches.")),e})}},u=o.hypergeometricRule=function(e,n){var a=0,r=[0,0],t=e.map(function(e,t){return r[0]+=e,r[1]+=n[t],a+=e+n[t],e+n[t]}),o=new Array(a+1);r.concat(t).forEach(function(e){for(var n=2;n<=e;n++)o[n]=1+(0|o[n])}),[a].concat(e,n).forEach(function(e){for(var n=2;n<=e;n++)o[n]=(0|o[n])-1});for(var u=1,s=2,i=2;s<=a||i<=a;)u<=1&&s<=a?(o[s]>0&&(u*=Math.pow(s,o[s])),s++):(o[i]<0&&(u*=Math.pow(i,o[i])),i++);return u};return o.fisher2x2=function(e,n,a){t(2!==e.length||2!==n.length,"Contingency table should be 2x2!"),a=isNaN(a)?.05:+a;var r=e[0],o=e[1],s=n[0],i=n[1],c=r+o,l=s+i,m=r+s,f=o+i,h=Math.abs(r/c-s/l),p=Math.min(m,c),_=0;for(r=0;r<=p;r++)s=m-r,i=f-(o=c-r),Math.abs(r/c-s/l)>=h&&(_+=u([r,o],[s,i]));return{p_value:_,comparison:_>a?0:e[0]-n[0]}},o.fisher2x3=function(e,n,a){t(3!==e.length||3!==n.length,"Contingency table should be 2x3!"),a=isNaN(a)?.05:+a;var r,o=e[0],s=e[1],i=e[2],c=n[0],l=n[1],m=n[2],f=o+s+i,h=o+c,p=s+l,_=i+m,y=u([o,s,i],[c,l,m]),g=0;for(o=0;o<=f;o++)for(s=0;s<=f-o;s++)(r=u([o,s,i=f-o-s],[c=h-o,l=p-s,m=_-i]))<=y&&(g+=r);return{p_value:g,comparison:g>a?0:e[0]-n[0]||(e[1]-row[1])/(p+1)}},o});
//# sourceMappingURL=ludorum-player-assess-tag.min.js.map