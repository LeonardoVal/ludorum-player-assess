//! ludorum-player-assess 0.0.1

(function(e){"use strict";this["ludorum-player-assess"]=e(this.base,this.Sermat,this.ludorum)}).call(this,function e(n,a,t){"use strict";var r=n.raiseIf,o={__package__:"ludorum-player-assess",__name__:"ludorum_player_assess",__init__:e,__dependencies__:[n,a],ludorum:t,__SERMAT__:{include:[n,t]}},u=o.statistics={};o.compare=function(e){r(!e||!e.game,"Missing `game` argument!");var a,o=e.game,u=e.players||[new t.players.RandomPlayer({name:"RandomPlayer"})],i=e.opponents||[new t.players.RandomPlayer({name:"RandomOpponent"})],s=+e.matchCount||400,c=e.logger,l=u.map(function(e){return new t.tournaments.Measurement(o,e,i,s)});if(c){c.info("Starting "+s*u.length*2+" matches of "+o.name+".");var m=0;l.forEach(function(e){e.events.on("afterMatch",function(){m++})}),a=setInterval(function(){c.info("Played "+m+"/"+s*u.length*2+" matches.")},e.logTime||2e4)}return n.Future.all(l.map(function(e){return e.run()})).then(function(){return l.map(function(e,a){var t=e.statistics,r=u[a],i=n.iterable(o.players).map(function(e){return[e,[t.count({key:"victories",role:e,player:r.name}),t.count({key:"draws",role:e,player:r.name}),t.count({key:"defeats",role:e,player:r.name})]]}).toObject();return i.player=r.name,i})}).then(function(e){return c&&(clearInterval(a),c.info("Played "+m+"/"+s*u.length*2+" matches.")),e})};var i=u.hypergeometricRule=function(e,n){var a=0,t=[0,0],r=e.map(function(e,r){return t[0]+=e,t[1]+=n[r],a+=e+n[r],e+n[r]}),o=new Array(a+1);t.concat(r).forEach(function(e){for(var n=2;n<=e;n++)o[n]=1+(0|o[n])}),[a].concat(e,n).forEach(function(e){for(var n=2;n<=e;n++)o[n]=(0|o[n])-1});for(var u=1,i=2,s=2;i<=a||s<=a;)u<=1&&i<=a?(o[i]>0&&(u*=Math.pow(i,o[i])),i++):(o[s]<0&&(u*=Math.pow(s,o[s])),s++);return u};return u.fisher2x2=function(e,n,a){r(2!==e.length||2!==n.length,"Contingency table should be 2x2!"),a=isNaN(a)?.05:+a;var t=e[0],o=e[1],u=n[0],s=n[1],c=t+o,l=u+s,m=t+u,f=Math.abs(t/c-u/l),h=Math.min(c,m),p=0;for(t=0;t<=h;t++)o=c-t,(s=l-(u=m-t))>=0&&Math.abs(t/c-u/l)>=f&&(p+=i([t,o],[u,s]));return{p_value:p,comparison:p>a?0:e[0]-n[0]}},u.fisher2x3=function(e,n,a){r(3!==e.length||3!==n.length,"Contingency table should be 2x3!"),a=isNaN(a)?.05:+a;var t,o,u=e[0],s=e[1],c=e[2],l=n[0],m=n[1],f=n[2],h=u+s+c,p=u+l,_=s+m,y=c+f,g=i([u,s,c],[l,m,f]),d=Math.min(h,p),v=0;for(u=0;u<=d;u++)for(o=Math.min(h-u,_),s=0;s<=o;s++)l=p-u,m=_-s,(f=y-(c=h-u-s))>=0&&(t=i([u,s,c],[l,m,f]))<=g&&(v+=t);return{p_value:v,comparison:v>a?0:e[0]-n[0]||(e[1]-row[1])/(_+1)}},o});
//# sourceMappingURL=ludorum-player-assess-tag.min.js.map